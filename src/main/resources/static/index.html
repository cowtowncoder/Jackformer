<!doctype html>
<html lang="en">
  <head><title>Jackformer!</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/> 
<link rel='stylesheet' type='text/css' href='css/style_1.3.css'>
<script type='text/javascript' src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script type='text/javascript'>
  var currentInputFormat = "";
  var currentOutputFormat = "";
  var currentInputMode = "";
  var currentInputFile = "";
  var currentInputText = 0; // 0/1 for empty/non-empty

function updateUIState() {
  if (currentInputFormat) { // got valid input format choice
    showRow($("#input-format-row"));
    if (currentOutputFormat) { // got valid output format choice
      showRow($("#output-format-row"));
      var result = updateUIStateByInputMode();
      if (result) { // got input content select!
        activateRow("action");
      } else { // no input mode
        hideRow($("#action-row"));
      }
    } else {
      activateRow("output-format");
      hideRow($("#input-mode-row"));
      hideRow($("#input-row"));
      hideRow($("#action-row"));
    }
  } else { // no valid choice
      activateRow("input-format");
      hideRow($("#output-format-row"));
      hideRow($("#input-mode-row"));
      hideRow($("#input-as-file-row"));
      hideRow($("#input-as-text-row"));
      hideRow($("#action-row"));
  }
}

function updateUIStateByInputMode() {
  if (currentInputMode == "input-mode-file") {
    showRow($("#input-mode-row"));
    activateRow("input-as-file");
    hideRow($("#input-as-text-row"));
    return currentInputFile;
  }
  if (currentInputMode == "input-mode-text") {
    showRow($("#input-mode-row"));
    hideRow($("#input-as-file-row"));
    activateRow("input-as-text");
    return currentInputText;
  }
  // No valid selection
  activateRow("input-mode");
  hideRow($("#input-as-file-row"));
  hideRow($("#input-as-text-row"));
  return false;
}

function hideRow(row) {
  row.removeClass("shown active").addClass("hidden");
}
function showRow(row) {
  row.removeClass("hidden active").addClass("shown");
}
function activateRow(idBase) {
  // activate row via class; put focus on selector
  $("#"+idBase+"-row").removeClass("hidden shown").addClass("active");
  $("#"+idBase).focus();
}
</script>
  </head>
  <body>
    <h1>Jackformer</h1>
<div>Are We Ready To Transform Things?!
</div>
<form>
 <table class="infoTable">
  <tr id="input-format-row" class="infoRow active">
<td class="label"><span class="prompt">* </span><label for="input-format">Input Format</label></td>
<td class="selector"><select id="input-format" size="1">
   <option value=""></option>
   <option value="json">JSON</option>
   <option value="properties">Properties</option>
   <option value="xml">XML</option>
   <option value="yaml">YAML</option>
</select></td>
   </tr>
  <tr id="output-format-row" class="infoRow hidden">
<td class="label"><span class="prompt">* </span><label for="output-format">Output Format</label></td>
<td class="selector"><select id="output-format">
   <option value=""></option>
   <option value="json">JSON</option>
   <option value="properties">Properties</option>
   <option value="xml">XML</option>
   <option value="yaml">YAML</option>
</select></td>
   </tr>
  <tr id="input-mode-row" class="infoRow hidden">
<td class="label"><span class="prompt">* </span>Input Source</td>
<td class="selector"><select id="input-mode">
   <option value=""></option>
   <option value="input-mode-text">Text</option>
   <option value="input-mode-file">Upload</option>
</select></td>
   </tr>
  <tr id="input-as-file-row" class="infoRow hidden collapsed">
<td class="label"><span class="prompt">* </span>Input File</td>
<td class="selector"><input type="file" id="input-as-file"></input>
   </tr>
  <tr id="input-as-text-row" class="infoRow hidden collapsed">
<td class="label"><span class="prompt">* </span>Input Content</td>
<td class="selector"><textarea id="input-as-text" rows="12" cols="80"></textarea>
   </tr>
  <tr id="action-row" class="infoRow hidden">
<td class="label"> </td>
<td class="selector">
<button type="button" id="button-show">Show Results</button>
<button type="button" id="button-download">Download Results</button>
    </td>
   </tr>
 </table>
</form>

<script>
$("#input-format").on("change", function() {
  var inputFormat = $(this).val();
  if (currentInputFormat != inputFormat) {
    currentInputFormat = inputFormat;
    updateUIState();
  }
});
$("#output-format").on("change", function() {
  var outputFormat = $(this).val();
  if (currentOutputFormat != outputFormat) {
    currentOutputFormat = outputFormat;
    updateUIState();
  }
});
$("#input-mode").on("change", function() {
  var inputMode = $(this).val();
  if (currentInputMode != inputMode) {
    currentInputMode = inputMode;
    updateUIState();
  }
});
$("#input-as-file").on("change", function() {
  var inputFile = $(this).val();
  if (currentInputFile != inputFile) {
    currentInputFile = inputFile;
    updateUIState();
  }
});
// Textareas are tricky. 'Change' only triggers on losing focus so need
// to also do "keyup" it seems
var inputAsText = $("#input-as-text");
var inputAsTextFunc = function() {
  var inputStr = $(this).val();
  var inputText = Math.min(inputStr.length, 1);
  if (currentInputText != inputText) {
    currentInputText = inputText;
    updateUIState();
  }
};
inputAsText.on("change", inputAsTextFunc);
inputAsText.on("keyup", inputAsTextFunc);

// Finally, activate the input format selector directly:
$("#input-format").focus();
</script>

  </body>
</html>
